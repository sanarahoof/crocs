import"./sentry-5xKLdfrE.js";import{r as y,j as e,T as U,R as E}from"./react-core-CK2DDeIb.js";import{H as j,O as B,J as D}from"./common-components-t3olDtXv.js";import{f as W}from"./components-DxGIc0Vi.js";import{h as F,f as q,e as H,b8 as $,bo as G,bp as K,bq as z,br as J,bs as Q,bt as V,bg as X,bu as Y,q as h,K as Z,bv as ee,bw as te,bx as re,by as se,bz as oe,bA as ne,bB as ae,bC as ie,bD as ce,bE as S,p as le,m as de,c as x,at as k}from"./lib-DcmKM84b.js";import{O as pe}from"./react-hot-toast-CGWlzGbK.js";import{u as L,B as _}from"./react-router-dom-B3mYs4-P.js";import"./assests-BGiCq0Zz.js";/* empty css                */import"./vendor-MKbYTGK1.js";import"./index-COy00iZx.js";import"./vendor-styling-CxWFyLSM.js";import"./react-ui-BxUbkExn.js";import"./ui-@shadcn-D0QUw6hz.js";import"./framer-BvjMl1io.js";import"./ui-NumberTicker-BmhxXLur.js";import"./ui-helpers-C2otJtgz.js";import"./ui-confetti-MT9rA1WN.js";import"./ui-carousels-L7HLKwfE.js";import"./ui-popup-buJtfXFN.js";import"./ui-marquee-uAE2P10n.js";import"./checkout-components-BB2RvPA6.js";import"./react-i18next-BjEYYCCw.js";import"./auth-components-DUOQG8ls.js";import"./react-phone-input-r_CunR7B.js";import"./js-cookie-CR4gOKBE.js";import"./i18next-BbZsaLss.js";import"./upsell-components-B_NODI7X.js";import"./page-CartWrapper-CVLcBfaD.js";import"./page-empty-cart-Bqto5aD_.js";import"./cart-components-CrsLllp5.js";import"./page-cart-BMlNZkfB.js";import"./ui-progress-bar-DOU0j6W9.js";import"./ui-icons-BvC-bYJD.js";import"./page-DummyCart-RSI5066e.js";import"./page-main-checkout-DXR9oDkH.js";import"./axios-BvjBzqU3.js";import"./bowser-CCPOuGtF.js";import"./jwt-decode-pDWbxs0Y.js";import"./nanoid-CcPoVmVj.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},i=new t.Error().stack;i&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[i]="8d05eee5-1d21-4ce6-a3a4-f67c2bcee29f",t._sentryDebugIdIdentifier="sentry-dbid-8d05eee5-1d21-4ce6-a3a4-f67c2bcee29f")}catch{}})();(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))p(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&p(n)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function p(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();function at(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const it=["/flo-checkout/api/attributes/v1/account-attributes",/\/kratos\/api\/v1\/checkout\/[^\/]+\/rewards/,/\/kratos\/api\/v1\/checkout\/[^\/]+\/upsell/,/\/kratos\/api\/v1\/checkout\/[^\/]+\/address\/[^\/]+\/etd/],ue="modulepreload",me=function(t){return"/stable/"+t},C={},ct=function(i,o,p){let r=Promise.resolve();if(o&&o.length>0){let u=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),a=n?.nonce||n?.getAttribute("nonce");r=u(o.map(c=>{if(c=me(c),c in C)return;C[c]=!0;const d=c.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const l=document.createElement("link");if(l.rel=d?"stylesheet":ue,d||(l.as="script"),l.crossOrigin="",l.href=c,a&&l.setAttribute("nonce",a),document.head.appendChild(l),d)return new Promise((b,w)=>{l.addEventListener("load",b),l.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(n){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=n,window.dispatchEvent(a),!a.defaultPrevented)throw n}return r.then(n=>{for(const a of n||[])a.status==="rejected"&&s(a.reason);return i().catch(s)})};function fe(){const{state:{isAuthenticating:t},actions:{setLoggedIn:i,setIsAuthenticating:o}}=F(),{state:{redirectUrl:p},actions:{setCheckoutId:r}}=q(),{actions:{setUserData:s,deleteAddressCache:n,updateUser:a}}=H(),[u,c]=L(),d=u.get("page")?.toLowerCase(),[m,l]=y.useState(!1),{isLoading:b}=$();y.useEffect(()=>{G(),T(),K(),w()},[d]);const w=()=>{const f=z(J.SHOPFLO_CHANNEL);return f.onMessage(g=>{g.type===Q.USER_LOGGED_OUT&&(r(""),s({uid:"",email:"",phone:"",name:"",default_billing_address:void 0,default_shipping_address:void 0,addresses:void 0,hasHomeAddr:!1,hasWorkAddr:!1}),n())}),()=>{f.close()}},T=async()=>{const f=u.get("auth"),g=u.get("forceRefresh"),{isLoggedIn:v,newTokensGenerated:M=!1}=await V(f??void 0,g==="true"||!!f);g==="true"&&v&&c(P=>(P.delete("auth"),P.delete("forceRefresh"),P)),i(v,{loginType:v?"COOKIE":void 0}),o(!1),M&&a()},N=()=>{window.history.pushState(null,"",null),l(!1),setTimeout(()=>{document?.documentElement?.style?.removeProperty("overflow")},500)},I=async()=>{l(!1),X(p)};return t&&d&&d!=="marketing-popup"?e.jsx(j,{"data-sentry-element":"Skeleton","data-sentry-component":"App","data-sentry-source-file":"App.tsx"}):e.jsxs(e.Fragment,{children:[e.jsx(W,{"data-sentry-element":"AppRouter","data-sentry-source-file":"App.tsx"}),e.jsx(pe,{"data-sentry-element":"Toaster","data-sentry-source-file":"App.tsx"}),!!b&&e.jsx(B,{}),e.jsx(D,{closeCheckout:I,isOpen:m,closePopup:N,"data-sentry-element":"CheckoutExitPopup","data-sentry-source-file":"App.tsx"})]})}Y();const O=new URLSearchParams(window.location.search),R=O.get("page")?.toLowerCase(),he=O.get("page")==="marketing-popup",ge=document.getElementById("root"),A=U.createRoot(ge),xe=h()&&!Z()&&!["cart","empty-cart","login-status-check","ghost-modal","marketing-popup","experiments-widget"].includes(R??"");xe?A.render(e.jsx(E.StrictMode,{children:e.jsx(_,{basename:"/stable",children:e.jsx(ye,{})})})):A.render(e.jsx(E.StrictMode,{children:e.jsx(_,{basename:"/stable",children:e.jsx(ee,{children:e.jsx(te,{children:e.jsx(re,{children:e.jsx(se,{children:e.jsx(be,{children:e.jsx(y.Suspense,{fallback:he?e.jsx(e.Fragment,{}):e.jsx(j,{}),children:e.jsx(oe,{children:e.jsx(ne,{children:e.jsx(ae,{children:e.jsx(ie,{children:e.jsx(ce,{children:e.jsx(fe,{})})})})})})})})})})})})})}));function ye(){return S(),y.useEffect(()=>{const t=new URL(document.location.href);le(de.PARENT_REDIRECT,{redirectUrl:t.href,clearCart:!1,isSso:R==="login-sso"})},[]),e.jsx(j,{"data-sentry-element":"Skeleton","data-sentry-component":"RedirectWrapper","data-sentry-source-file":"index.tsx"})}function be({children:t}){const[i]=L(),o=i.get("page"),p=["cart","empty-cart"].includes(o?.toLowerCase()??""),r=o==="login-sso",s=o==="marketing-popup",n=o==="wishlist",a=o==="mock-checkout",u=o==="experiments-widget";return S(),s?e.jsx("div",{id:"checkout-ui-root",className:x("relative overflow-hidden md:h-fit md:w-[25rem] w-full","md:shadow-[0px_0px_10px_0px_rgba(0,0,0,0.1)]"),children:t}):p?e.jsx("div",{id:"checkout-ui-root",className:"relative h-full w-full overflow-hidden bg-gray-lightest md:h-[85vh] md:w-[25rem] md:rounded-l-[28px] md:rounded-r-none  md:shadow-[0px_0px_10px_0px_rgba(0,0,0,0.1)]",children:t}):r?e.jsx("div",{className:`flex h-full w-full overflow-hidden bg-gray-lighter ${h()?"justify-center":"flex-col items-center justify-center"}`,children:e.jsx("div",{className:x("h-[400px] w-[360px] border border-carbon-lighter bg-white md:h-[400px]",k()?"rounded-xl":"relative w-[360px] rounded-[20px] md:w-[360px]",h()?"!w-full !rounded-xl":""),children:t})}):n?e.jsx("div",{className:"h-full w-full overflow-hidden bg-transparent",children:t}):a?e.jsx("div",{id:"checkout-ui-root",className:x("relative h-full w-full bg-gray-lightest md:h-[85vh] md:w-[69rem]",k()?"":h()?"rounded-[28px]":"md:rounded-[28px]","md:shadow-[0px_0px_10px_0px_rgba(0,0,0,0.1)]"),children:t}):u?e.jsx("div",{className:"h-full w-full overflow-hidden bg-transparent",children:t}):e.jsx("div",{id:"checkout-ui-root",className:x("relative h-full w-full overflow-hidden bg-gray-lightest md:h-[85vh] md:w-[25rem]",k()?"":h()?"rounded-[28px]":"md:rounded-[28px]","md:shadow-[0px_0px_10px_0px_rgba(0,0,0,0.1)]"),"data-sentry-component":"AppShell","data-sentry-source-file":"index.tsx",children:t})}window.addEventListener("vite:preloadError",()=>{window.location.reload()});export{it as A,ct as _,at as g};
//# sourceMappingURL=index-COy00iZx.js.map
